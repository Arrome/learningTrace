# 硬链接和软链接

文件：
1. 用户数据(文件数据块，记录文件真实内容)
2. 元数据(文件附加属性，文件大小、创建时间、所有者等信息)
> inode (索引节点号)是元数据一部分，但不包含文件名。<br>
> **inode 是文件唯一标识而非文件名。系统或程序通过inode号来寻找正确的文件数据块**

解决文件共享使用，隐藏文件路径，增加权限安全及节省存储等好处

硬链接
--------
**概念**：有相同inode号，仅文件名不同的文件<br>
**命令**：
```
link oldfile newfile
ln oldfile newfile
```
**特点**：
  * 文件有相同的 inode 及 data block；
  * 只能对已存在的文件进行创建；
  * 不能交叉文件系统进行硬链接的创建,只能在同一文件系统；
  * 不能对目录进行创建，只可对文件创建；<br>
    目录隐藏的两个目录(当前目录.与父目录..)两个特殊目录的inode号知是两个硬链接.若系统允许对目录创建硬链接会产生目录环
  * 删除一个硬链接文件并不影响其他有相同 inode 号的文件。

软链接
--------
**概念**：
  软链接就是一个普通文件，只是数据块内容有点特殊.**文件用户数据块中存放的内容是另一文件的路径名的指向**<br>

**命令**：
`ln -s old.file soft.link`<br>

**特点**：
  * 软链接有自己的文件属性及权限等；
  * 可对不存在的文件或目录创建软链接；
  * 软链接可交叉文件系统；
  * 软链接可对文件或目录创建；
  * 创建软链接时，链接计数 i_nlink 不会增加；
  * 删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）
> **软链接创建时原文件的路径指向使用绝对路径较好**.使用相对路径创建的软链接被移动后该软链接文件将成为一个死链接

```
// 查找在路径 /home 下的文件 data.txt 的软链接
find /home -lname data.txt

// 查看路径 /home 有相同 inode 的所有硬链接
find /home -samefile /home/harris/debug/test3/old.file  

find /home -inum 660650

// 列出路径 /home/harris/debug/ 下的所有软链接文件
find /home/harris/debug/ -type l -ls

```

**系统根据磁盘的大小默认设定了 inode 的值**，如若必要，可在格式文件系统前对该值进行修改:<br>
`mkfs -t ext4 -I 512 /dev/sda4`，将使磁盘设备 /dev/sda4 格式成 inode 大小是 512 字节的 ext4 文件系统
