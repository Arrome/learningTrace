# 网络通信端口

哪种网络选择更合适，取决于谁(或哪个容器)使用Docker运行的服务。

|命令|功能|
|----|----|
|EXPOSE|记录服务可用的端口，但是并不创建和宿主机之间的映射|
|`--expose`|运行时暴露端口，但是并不创建和宿主机之间的映射|
|-p|创建端口映射规则，比如 -p ip:hostPort:containerPort.必须指定containerPort.如果没有指定hostPort，Docker自动分配端口，不指定IP默认绑定本机上所有接口的所有地址|
|-P|将Dockerfile里暴露的所有容器端口映射到动态分配的宿主机端口（49000~49900）上|
|`--link`|在消费者和服务容器之间创建连接，比如 --link name:alias.这会创建一系列环境变量，并在消费者容器的/ect/hosts文件里添加入口项。必须暴露或发布端口。|

> `EXPOSE` 和 `--expose` 暴露端口，本质无区别，只为其他命令提供所需信息的元数据(告诉容器操作人员有哪些已知选择)。都不依赖于宿主机，默认状态下，这些规则不会使这些端口可以通过宿主机来访问<br>
> `EXPOSE`在Dockerfile里定义，只将其作为哪个端口提供哪个服务的提示，使用时依赖容器操作人员进一步指定网络规则<br>
> `--expose`可以接受端口范围作为参数，例如：`--expose=2000-3000`；可在`EXPOSE`指令定义的端口之外暴露新增端口

> `-p` 发布端口，默认发布规则是tcp。如果为udp,需要最后加一指定，例如：`-p 1234:1234/udp`;可定义任意数量端口映射<br>
> `-P`和 `EXPOSE`结合使用，Docker会自动为用户创建端口映射规则，避免端口映射冲突<br>

> `--link` 几乎能提供和端口映射规则和环境变量相同的功能。对于需要隔离的小型项目非常有用，功能更像服务发现的工具，而不是网络流量的门户。<br>
**通过两种方式为容器公开连接信息：1. 环境变量（env查看） 2. 更新/etc/hosts文件**
