# 类的初始化

立即对类进行初始化，**有且只有**5种情况：
1. 遇到 new、getstatic、putstatic或 invokestatic 这4条字节码指令时，如果类没有进行过初始化，则需要先触发其初始化。<br>
 生成这4条指令的最常见的java代码场景：1. 使用new关键字实例化对象时，2. 读取或设置一个类的静态字段（被final修饰、已在编译期把结果放入常量池的静态字段除外） 3. 调用一个类的静态方法时
2. 使用 java.lang.reflect 包的方法对类进行反射调用的时候，如果类没有进行过初始化，则需要先触发其初始化
3. 当初始化一个类的时候，如果发现其父类还没有进行过初始化，则需要先触发其父类的初始化（接口在初始化时，并不要求父接口全部都完成初始化，只有真正使用到父接口的时候【如引用接口中定义的常量】，才会初始化）
4. 当虚拟机启动时，用户需要指定一个要执行的主类（包括main方法类），虚拟机会先初始化这个主类
5. 当使用JDK1.7动态语言支持时，如果一个java.lang.invoke.MethodHandle 实例最后的解析结果 REF_getStatic、REF_putStatic、REF_invokeStatic的方法句柄，且这个方法句柄对应的类没有进行过初始化，则需要先触发其初始化

> * **对于静态字段，只有直接定义这个字段的类才会被初始化**，因此通过其子类引用父类中定义的静态字段，只会触发父类的初始化而不会触发子类的初始化<br>
> * 通过数组定义来引用类，不会触发此类的初始化
> * 编译阶段通过常量传播优化，将类的常量存储到引用此常量的常量池中，两个类编译class之后就不存在任何联系了。
